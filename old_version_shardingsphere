commit c618972e85bec6981da0db8654d1e64cf7e833d4
Author: lanchengx <52209337+lanchengx@users.noreply.github.com>
Date:   Mon Dec 20 22:53:47 2021 +0800

    [DistSQL]Add DB_Discovery document and optimize verification logic (#14174)
    
    * Add Discovery related documents.
    
    * Fix failure when `Drop discovery type/heartbeat`.
    
    * Reformat.
    
    * Add document.

diff --git a/docs/document/content/user-manual/shardingsphere-proxy/distsql/syntax/rdl/rule-definition/db-discovery.cn.md b/docs/document/content/user-manual/shardingsphere-proxy/distsql/syntax/rdl/rule-definition/db-discovery.cn.md
index 312aa415e8..164c721af2 100644
--- a/docs/document/content/user-manual/shardingsphere-proxy/distsql/syntax/rdl/rule-definition/db-discovery.cn.md
+++ b/docs/document/content/user-manual/shardingsphere-proxy/distsql/syntax/rdl/rule-definition/db-discovery.cn.md
@@ -6,42 +6,120 @@ weight = 4
 ## 语法说明
 
 ```sql
-CREATE DB_DISCOVERY RULE databaseDiscoveryRuleDefinition [, databaseDiscoveryRuleDefinition] ...
+CREATE DB_DISCOVERY RULE ruleDefinition [, ruleDefinition] ...
 
-ALTER DB_DISCOVERY RULE databaseDiscoveryRuleDefinition [, databaseDiscoveryRuleDefinition] ...
+ALTER DB_DISCOVERY RULE ruleDefinition [, ruleDefinition] ...
 
 DROP DB_DISCOVERY RULE ruleName [, ruleName] ...
 
-databaseDiscoveryRuleDefinition:
-    ruleName(resources, discoveryTypeDefinition)
+CREATE DB_DISCOVERY TYPE databaseDiscoveryTypeDefinition [, databaseDiscoveryTypeDefinition] ...
+
+ALTER DB_DISCOVERY TYPE databaseDiscoveryTypeDefinition [, databaseDiscoveryTypeDefinition] ...
+
+DROP DB_DISCOVERY TYPE discoveryTypeName [, discoveryTypeName] ...
+
+CREATE DB_DISCOVERY HEARTBEAT databaseDiscoveryHeartbaetDefinition [, databaseDiscoveryHeartbaetDefinition] ...
+
+ALTER DB_DISCOVERY HEARTBEAT databaseDiscoveryHeartbaetDefinition [, databaseDiscoveryHeartbaetDefinition] ...
+
+DROP DB_DISCOVERY HEARTBEAT discoveryHeartbeatName [, discoveryHeartbeatName] ...
+
+ruleDefinition:
+    (databaseDiscoveryRuleDefinition | databaseDiscoveryRuleConstruction)
+
+databaseDiscoveryRuleDefinition
+    ruleName (resources, typeDefinition, heartbeatDefinition)
+
+databaseDiscoveryRuleConstruction
+    ruleName (resources, TYPE = discoveryTypeName, HEARTBEAT = discoveryHeartbeatName)
+
+databaseDiscoveryTypeDefinition
+    discoveryTypeName (typeDefinition)
+
+databaseDiscoveryHeartbaetDefinition
+    discoveryHeartbeatName (PROPERTIES (properties)) 
 
 resources:
     RESOURCES(resourceName [, resourceName] ...)
 
-discoveryTypeDefinition:
-    TYPE(NAME=discoveryType [, PROPERTIES([algorithmProperties] )] )
+typeDefinition:
+    TYPE(NAME=typeName [, PROPERTIES([properties] )] )
+
+heartbeatDefinition
+    HEARTBEAT (PROPERTIES (properties)) 
 
-algorithmProperties:
-    algorithmProperty [, algorithmProperty] ...
+properties:
+    property [, property] ...
 
-algorithmProperty:
+property:
     key=value                          
 ```
+
 - `discoveryType` 指定数据库发现服务类型，`ShardingSphere` 内置支持 `MGR`
 - 重复的 `ruleName` 将无法被创建
+- 正在被使用的 `discoveryType` 和 `discoveryHeartbeat` 无法被删除
+- 带有 `-` 的命名在改动时需要使用 `" "`
+- 移除 `discoveryRule` 时不会移除被该 `discoveryRule` 使用的 `discoveryType` 和 `discoveryHeartbeat`
 
 ## 示例
 
+### 创建 `discoveryRule` 时同时创建 `discoveryType` 和 `discoveryHeartbeat`
+
 ```sql
 CREATE DB_DISCOVERY RULE ha_group_0 (
-RESOURCES(resource_0,resource_1),
-TYPE(NAME=mgr,PROPERTIES(groupName='92504d5b-6dec',keepAliveCron=''))
+RESOURCES(ds_0, ds_1, ds_2),
+TYPE(NAME=mgr,PROPERTIES('groupName'='92504d5b-6dec')),
+HEARTBEAT(PROPERTIES('keepAliveCron'='0/5 * * * * ?'))
 );
 
 ALTER DB_DISCOVERY RULE ha_group_0 (
-RESOURCES(resource_0,resource_1,resource_2),
-TYPE(NAME=mgr,PROPERTIES(groupName='92504d5b-6dec' ,keepAliveCron=''))
+RESOURCES(ds_0, ds_1, ds_2),
+TYPE(NAME=mgr,PROPERTIES('groupName'='246e9612-aaf1')),
+HEARTBEAT(PROPERTIES('keepAliveCron'='0/5 * * * * ?'))
 );
 
 DROP DB_DISCOVERY RULE ha_group_0;
+
+DROP DB_DISCOVERY TYPE ha_group_0_mgr;
+
+DROP DB_DISCOVERY HEARTBEAT ha_group_0_heartbeat;
+
 ```
+
+### 使用已有的 `discoveryType` 和 `discoveryHeartbeat` 创建 `discoveryRule`
+
+```sql
+CREATE DB_DISCOVERY TYPE ha_group_1_mgr(
+  TYPE(NAME=mgr,PROPERTIES('groupName'='92504d5b-6dec'))
+);
+
+CREATE DB_DISCOVERY HEARTBEAT ha_group_1_heartbeat(
+  PROPERTIES('keepAliveCron'='0/5 * * * * ?')
+);
+
+CREATE DB_DISCOVERY RULE ha_group_1 (
+RESOURCES(ds_0, ds_1, ds_2),
+TYPE=ha_group_1_mgr,
+HEARTBEAT=ha_group_1_heartbeat
+);
+
+ALTER DB_DISCOVERY TYPE ha_group_1_mgr(
+  TYPE(NAME=mgr,PROPERTIES('groupName'='246e9612-aaf1'))
+);
+
+ALTER DB_DISCOVERY HEARTBEAT ha_group_1_heartbeat(
+  PROPERTIES('keepAliveCron'='0/10 * * * * ?')
+);
+
+ALTER DB_DISCOVERY RULE ha_group_1 (
+RESOURCES(ds_0, ds_1),
+TYPE=ha_group_1_mgr,
+HEARTBEAT=ha_group_1_heartbeat
+);
+
+DROP DB_DISCOVERY RULE ha_group_1;
+
+DROP DB_DISCOVERY TYPE ha_group_1_mgr;
+
+DROP DB_DISCOVERY HEARTBEAT ha_group_1_heartbeat;
+```
\ No newline at end of file
diff --git a/docs/document/content/user-manual/shardingsphere-proxy/distsql/syntax/rdl/rule-definition/db-discovery.en.md b/docs/document/content/user-manual/shardingsphere-proxy/distsql/syntax/rdl/rule-definition/db-discovery.en.md
index 9ab39a29ea..bd712d248c 100644
--- a/docs/document/content/user-manual/shardingsphere-proxy/distsql/syntax/rdl/rule-definition/db-discovery.en.md
+++ b/docs/document/content/user-manual/shardingsphere-proxy/distsql/syntax/rdl/rule-definition/db-discovery.en.md
@@ -6,42 +6,121 @@ weight = 4
 ## Syntax
 
 ```sql
-CREATE DB_DISCOVERY RULE databaseDiscoveryRuleDefinition [, databaseDiscoveryRuleDefinition] ...
+CREATE DB_DISCOVERY RULE ruleDefinition [, ruleDefinition] ...
 
-ALTER DB_DISCOVERY RULE databaseDiscoveryRuleDefinition [, databaseDiscoveryRuleDefinition] ...
+ALTER DB_DISCOVERY RULE ruleDefinition [, ruleDefinition] ...
 
 DROP DB_DISCOVERY RULE ruleName [, ruleName] ...
 
-databaseDiscoveryRuleDefinition:
-    ruleName(resources, discoveryTypeDefinition)
+CREATE DB_DISCOVERY TYPE databaseDiscoveryTypeDefinition [, databaseDiscoveryTypeDefinition] ...
+
+ALTER DB_DISCOVERY TYPE databaseDiscoveryTypeDefinition [, databaseDiscoveryTypeDefinition] ...
+
+DROP DB_DISCOVERY TYPE discoveryTypeName [, discoveryTypeName] ...
+
+CREATE DB_DISCOVERY HEARTBEAT databaseDiscoveryHeartbaetDefinition [, databaseDiscoveryHeartbaetDefinition] ...
+
+ALTER DB_DISCOVERY HEARTBEAT databaseDiscoveryHeartbaetDefinition [, databaseDiscoveryHeartbaetDefinition] ...
+
+DROP DB_DISCOVERY HEARTBEAT discoveryHeartbeatName [, discoveryHeartbeatName] ...
+
+ruleDefinition:
+    (databaseDiscoveryRuleDefinition | databaseDiscoveryRuleConstruction)
+
+databaseDiscoveryRuleDefinition
+    ruleName (resources, typeDefinition, heartbeatDefinition)
+
+databaseDiscoveryRuleConstruction
+    ruleName (resources, TYPE = discoveryTypeName, HEARTBEAT = discoveryHeartbeatName)
+
+databaseDiscoveryTypeDefinition
+    discoveryTypeName (typeDefinition)
+
+databaseDiscoveryHeartbaetDefinition
+    discoveryHeartbeatName (PROPERTIES (properties)) 
 
 resources:
     RESOURCES(resourceName [, resourceName] ...)
 
-discoveryTypeDefinition:
-    TYPE(NAME=discoveryType [, PROPERTIES([algorithmProperties] )] )
+typeDefinition:
+    TYPE(NAME=typeName [, PROPERTIES([properties] )] )
+
+heartbeatDefinition
+    HEARTBEAT (PROPERTIES (properties)) 
 
-algorithmProperties:
-    algorithmProperty [, algorithmProperty] ...
+properties:
+    property [, property] ...
 
-algorithmProperty:
+property:
     key=value                          
 ```
+
 - `discoveryType` specifies the database discovery service type, `ShardingSphere` has built-in support for `MGR`
 - Duplicate `ruleName` will not be created
+- The `discoveryType` and `discoveryHeartbeat` being used cannot be deleted
+- Names with `-` need to use `" "` when changing
+- When removing the `discoveryRule`, the `discoveryType` and `discoveryHeartbeat` used by the `discoveryRule` will not be removed
+
 
 ## Example
 
+### When creating a `discoveryRule`, create both `discoveryType` and `discoveryHeartbeat`
+
 ```sql
 CREATE DB_DISCOVERY RULE ha_group_0 (
-RESOURCES(resource_0,resource_1),
-TYPE(NAME=mgr,PROPERTIES(groupName='92504d5b-6dec',keepAliveCron=''))
+RESOURCES(ds_0, ds_1, ds_2),
+TYPE(NAME=mgr,PROPERTIES('groupName'='92504d5b-6dec')),
+HEARTBEAT(PROPERTIES('keepAliveCron'='0/5 * * * * ?'))
 );
 
 ALTER DB_DISCOVERY RULE ha_group_0 (
-RESOURCES(resource_0,resource_1,resource_2),
-TYPE(NAME=mgr,PROPERTIES(groupName='92504d5b-6dec' ,keepAliveCron=''))
+RESOURCES(ds_0, ds_1, ds_2),
+TYPE(NAME=mgr,PROPERTIES('groupName'='246e9612-aaf1')),
+HEARTBEAT(PROPERTIES('keepAliveCron'='0/5 * * * * ?'))
 );
 
 DROP DB_DISCOVERY RULE ha_group_0;
+
+DROP DB_DISCOVERY TYPE ha_group_0_mgr;
+
+DROP DB_DISCOVERY HEARTBEAT ha_group_0_heartbeat;
+
 ```
+
+### Use the existing `discoveryType` and `discoveryHeartbeat` to create a `discoveryRule`
+
+```sql
+CREATE DB_DISCOVERY TYPE ha_group_1_mgr(
+  TYPE(NAME=mgr,PROPERTIES('groupName'='92504d5b-6dec'))
+);
+
+CREATE DB_DISCOVERY HEARTBEAT ha_group_1_heartbeat(
+  PROPERTIES('keepAliveCron'='0/5 * * * * ?')
+);
+
+CREATE DB_DISCOVERY RULE ha_group_1 (
+RESOURCES(ds_0, ds_1, ds_2),
+TYPE=ha_group_1_mgr,
+HEARTBEAT=ha_group_1_heartbeat
+);
+
+ALTER DB_DISCOVERY TYPE ha_group_1_mgr(
+  TYPE(NAME=mgr,PROPERTIES('groupName'='246e9612-aaf1'))
+);
+
+ALTER DB_DISCOVERY HEARTBEAT ha_group_1_heartbeat(
+  PROPERTIES('keepAliveCron'='0/10 * * * * ?')
+);
+
+ALTER DB_DISCOVERY RULE ha_group_1 (
+RESOURCES(ds_0, ds_1),
+TYPE=ha_group_1_mgr,
+HEARTBEAT=ha_group_1_heartbeat
+);
+
+DROP DB_DISCOVERY RULE ha_group_1;
+
+DROP DB_DISCOVERY TYPE ha_group_1_mgr;
+
+DROP DB_DISCOVERY HEARTBEAT ha_group_1_heartbeat;
+```
\ No newline at end of file
